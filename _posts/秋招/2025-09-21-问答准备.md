---
layout: post
title: "问答准备"
date: 2025-09-21
category: 秋招
---

**1、面试官：CCD和CMOS的区别**

它们最核心的区别是信号读取方式：**CCD是‘统一处理’**，所有像素信号排队到一个出口转换，画质均匀但速度慢、功耗高；**CMOS是‘独立处理’**，每个像素独立转换信号，速度飞快、功耗低、成本也低，现在技术成熟后画质也达到了顶尖水平。

> 注意其中出口转换，即将电荷转为电压


无论你怎么组织语言，一定要突出这三点：
1.  **先说核心不同**：信号读出架构不同（串行 vs 并行）。
2.  **再说优缺点**：CCD画质好、噪点低；CMOS速度快、功耗低、成本低。
3.  **最后说现状**：CMOS技术进步，已成为市场绝对主流。

**面试官：介绍一下你知道的白平衡算法**

白平衡算法的目的是估计场景的光源颜色，并通过调整 RGB 通道的增益，使图像整体看起来色温正确、无偏色。

常见的两种经典算法是灰度世界法和完美反射法：
- **灰度世界法**假设整幅图像的平均颜色是中性灰，通过计算 R、G、B 通道的均值来估计光源偏色，然后反向调整，使平均值回到中性。 
- 缺点是如果图像中大面积是单一色，比如蓝天或绿色草地，会导致估计不准。
- 另一种是**完美反射法**，假设场景中最亮的像素就是光源颜色。一般通过计算 RGB 最大值后，将其归一化为白点。
- 缺点是当最亮物体本身有色彩时，会造成偏差。

改进版本：

1. 加权灰度世界法 (Weighted Gray World)： 对“灰度世界法”的改进。它认为不是所有像素都同等重要，饱和度越低（越接近灰色）的像素，应该给予越高的权重。
2. Patch完美反射法”是“完美反射法”的一种改进算法。它不再是简单地寻找R, G, B三个通道的各自最大值，而是先找出图像中“最亮的一个小区域（Patch）”（例如亮度排名前1%的像素），然后计算这个区域内所有像素的R, G, B平均值，并以此作为光源颜色来校正图像。一句话总结：**它用“最亮区域的平均值”替代了“最亮的单个值”，大大提高了算法对噪点和彩色高光的抵抗能力，结果更稳定。**

基于色域的方法
核心假设：它的假设是“在特定光源下，场景中能出现的颜色范围（色域）是有限的”。

工作原理：算法会分析当前图像的整体色彩分布，尝试将其映射到预设的“标准色域”中。

目标与优势：算法会寻找一个最佳的光源估计（映射变换），使得图像中的像素能最大程度地落入这个标准色域内。它的优势是比简单的统计法（如灰度世界）更稳健，不易受大面积单色物体的干扰。
   
除了传统的算法，也了解过一些基于深度学习AWB方法。

简单来说 利用CNN网络，通过大量有有标注光源的数据集进行训练，让模型学会提取图像的语义特征。

> 常用的模型是 Fully Convolutional Neural Network。它的工作原理很有意思，不仅仅是提取特征，它还会学习一个**‘置信度图’（Confidence Map）或‘注意力机制’（Attention）**。简单说，网络会自动学会‘该信谁’。比如画面里有白墙、有人脸，网络会给这些区域很高的权重；而对于自发光物体（如霓虹灯）或大面积纯色（如草地），网络会给很低的权重，甚至忽略不计。最后通过加权池化（Weighted Pooling），得出一个全局的光源估计值。”

**3、为什么要做gamma校正**

做Gamma校正主要有两个原因：

- 一个是为了兼容历史标准。早期为了补偿CRT显示器固有的非线性亮度响应（Gamma ≈ 2.2），图像信号在制作时就进行了反向的Gamma编码（约1/2.2）。
- 另一个是为了补偿人眼的视觉机制。因为人眼对暗部变化更敏感，所以Gamma编码将更多数据位分配给暗部，避免在暗部出现色阶断层现象。

**4、刚才你有提到CCM，那你能讲一下吗**

CCM是用来完成设备颜色校正的一个矩阵。 它的核心作用是将一个设备相关的RGB映射到设备无关的色彩空间中，比如 sRGB 或 XYZ，以减小色差。

通常做法一般是通过将拍摄到的24色卡的测量值与他的一个标准值进行一个最小色差优化，来求得这样一个校正矩阵

显示器或者印刷行业对色彩准确度一般较高，所以CCM是不够的，我在做显示器特征化实验时就用过 GOG 模型。

**5、介绍一下3DLUT**

3DLUT就是一个3维查找表，类似于一个字典，通过将测量的输入输出数据填充到这个查找表中。当我们想要查找某一个输入时，就可以在查找表中查找是否存在这样一个输入节点，如果存在就可以直接输出他所对应的一个输出，如果不存在可以通过当前输入点他所在邻域所对应的八个邻接点进行插值获取。插值的话有好几种选择比如最临近插值、三线性插值或者四面体插值等

**5、LSC (镜头阴影校正)**

核心方法是增益补偿。通过拍摄均匀的灰板或白板，得到一张有“暗角”的图像。然后以画面中心亮度为基准，计算出一个增益图 (Gain Map)。这张图中心区域的增益接近1，越往边缘越大。在处理图像时，将这张增益图乘上去，就把边缘的亮度“抬”起来了，实现整个画面亮度均匀。

**6、 产生黑电平的原因？**

黑电平主要是由传感器的暗电流引起的。

即使在完全没有光线（镜头盖盖住）的情况下，传感器由于热噪声等物理因素，其光电二极管和电路本身也会产生一个微弱的、固定的电信号。这个“零点偏置”就是黑电平。ISP的首先（BLC）就是要把这个固定的暗电流值从所有像素中减去，以确保‘纯黑’的地方真正对应数字信号的零点。

**7、 好看的照片要素**

从画质工程师的角度看，一张‘好看’的照片是在几个关键维度上取得了最佳平衡：

曝光与对比度：首先要曝光准确，高光不过曝（不“死白”），暗部有细节（不“死黑”）。

色彩表现：这是我最关注的。白平衡要准（不色偏），保证图像不偏色。

清晰度与噪声：画面主体要清晰锐利，同时噪声（尤其是暗部）要控制得当，不能有明显的“涂抹感”或“颗粒感”。

无明显瑕疵：没有过度锐化导致的“光晕”，也没有摩尔纹等伪像。

**8、 描述一下成像**

好的。这个成像系统可以概括为：光线通过镜头(Lens)，照射到CMOS传感器上。传感器上的拜耳滤镜使每个像素只记录R、G、B中的一种颜色，产生RAW图。接着，RAW图被送入ISP（图像信号处理器）。ISP会执行一整套流程，包括黑电平校正、坏点校正、Lens shading校正、去马赛克、AWB（白平衡）、CCM（色彩校正）、Gamma校正、降噪和锐化等，最终输出我们能看到的RGB或YUV格式的全彩图像。

**描述一下高斯和双边滤波区别**

高斯滤波：只考虑像素之间的空间距离（Spatial Distance）。离得越近，权重越大。它是一个“无差别”的平滑，遇到边缘时，会把边缘两边的像素混在一起取平均，导致边缘模糊。

双边滤波：同时考虑了空间距离和像素值差异（Range/Intensity Difference）。只有当两个像素“距离近”且“颜色像”的时候，权重才大。这使得它在平坦区域进行平滑，但在边缘区域停止平滑，从而保留边缘。

**讲讲你在实习时调研了哪些行业上的色域映射算法**

我主要调研了几类主流的色域映射方案，包括一些行业系统和商业实现，比如 CSS、Windows、ColorAide 的策略。

- CSS 的算法是在等色调面下先沿等亮度轴压缩，当彩度压缩到一定阈值后再裁剪。这样既能保持整体的色调一致，也能减少彩度损失。它使用的是 2020 年提出的 Oklab 空间，相比 Lab 在蓝色区域的色调均匀性更好。

- Windows 提供了三种算法策略。常用的是加权裁剪算法，会在等色调面裁剪时对亮度赋权，从而避免低彩度区域出现过大偏差；第二种是对 CIE SGCK 算法的改进版本，将原本可能引起亮度翻转的问题改成了在等亮度下压缩；第三种是 hue mapping，在映射前做了一个色调校正，以保证彩度分布的一致性。

- 另外我也参考了一些学术上的算法，通过横向对比后发现，加权裁剪算法在细节、亮度和色调保持上整体最优，所以最后我们采用了这个方案。